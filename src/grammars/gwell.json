{"state":{"grammar":{"start":"main","rules":[{"name":"main","symbols":[{"rule":"_"},{"rule":"section_list"},{"rule":"_"}],"postprocess":{"template":"$1"}},{"name":"section_list","symbols":[{"rule":"section"}],"postprocess":{"template":"[$0]"}},{"name":"section_list","symbols":[{"rule":"section"},{"rule":"T_WS"},{"rule":"section_list"}],"postprocess":{"template":"[$0].concat($2)"}},{"name":"section","symbols":[{"rule":"K_CONFIG"},{"rule":"_"},{"rule":"L_TEMPLATEL"},{"rule":"_"},{"rule":"kv_list"},{"rule":"_"},{"rule":"L_TEMPLATER"}],"postprocess":{"template":"{ config: Rollup($4) }"}},{"name":"section","symbols":[{"rule":"K_LEXER"},{"rule":"_"},{"rule":"L_TEMPLATEL"},{"rule":"_"},{"rule":"lexer"},{"rule":"_"},{"rule":"L_TEMPLATER"}],"postprocess":{"template":"{ lexer: Rollup($4) }"}},{"name":"section","symbols":[{"rule":"K_GRAMMAR"},{"rule":"_"},{"rule":"L_TEMPLATEL"},{"rule":"_"},{"rule":"grammar"},{"rule":"_"},{"rule":"L_TEMPLATER"}],"postprocess":{"template":"{ grammar: $4 }"}},{"name":"section","symbols":[{"rule":"K_IMPORT"},{"rule":"_"},{"rule":"T_WORD"}],"postprocess":{"template":"{ import: $2 }"}},{"name":"section","symbols":[{"rule":"K_BODY"},{"rule":"_"},{"rule":"T_JS"}],"postprocess":{"template":"{ body: $2 }"}},{"name":"section","symbols":[{"rule":"K_HEAD"},{"rule":"_"},{"rule":"T_JS"}],"postprocess":{"template":"{ head: $2 }"}},{"name":"section","symbols":[{"rule":"K_IMPORT"},{"rule":"_"},{"rule":"T_STRING"}],"postprocess":{"template":"{ import: $2, path: true }"}},{"name":"section","symbols":[{"rule":"K_BODY"},{"rule":"_"},{"rule":"T_STRING"}],"postprocess":{"template":"{ body: $2, path: true }"}},{"name":"section","symbols":[{"rule":"K_HEAD"},{"rule":"_"},{"rule":"T_STRING"}],"postprocess":{"template":"{ head: $2, path: true }"}},{"name":"lexer","symbols":[{"rule":"kv_list"},{"rule":"_"},{"rule":"state_list"}],"postprocess":{"template":"$0.concat({ states: $2 })"}},{"name":"lexer","symbols":[{"rule":"state_list"}],"postprocess":{"template":"[{ states: $0 }]"}},{"name":"state_list","symbols":[{"rule":"state"}],"postprocess":{"template":"data"}},{"name":"state_list","symbols":[{"rule":"state"},{"rule":"_"},{"rule":"state_list"}],"postprocess":{"template":"[$0].concat($2)"}},{"name":"state","symbols":[{"rule":"state_declare"},{"rule":"_"},{"rule":"state_definition"}],"postprocess":{"template":"Rollup([{ name: $0 }].concat($2))"}},{"name":"state_declare","symbols":[{"rule":"T_WORD"},{"rule":"_"},{"rule":"L_ARROW"}],"postprocess":{"template":"$0"}},{"name":"state_definition","symbols":[{"rule":"kv_list"},{"rule":"_"},{"rule":"token_list"}],"postprocess":{"template":"Rollup($0.concat([{rules: $2}]))"}},{"name":"state_definition","symbols":[{"rule":"token_list"}],"postprocess":{"template":"{ rules: $0 }"}},{"name":"token_list","symbols":[{"rule":"token"}],"postprocess":{"template":"data"}},{"name":"token_list","symbols":[{"rule":"token"},{"rule":"_"},{"rule":"token_list"}],"postprocess":{"template":"[$0].concat($2)"}},{"name":"token","symbols":[{"rule":"L_DASH"},{"rule":"_"},{"rule":"K_IMPORT"},{"rule":"_"},{"rule":"L_COLON"},{"rule":"_"},{"rule":"word_list"}],"postprocess":{"template":"{ import: $6 }"}},{"name":"token","symbols":[{"rule":"L_DASH"},{"rule":"_"},{"rule":"token_definition_list"}],"postprocess":{"template":"Rollup($2)"}},{"name":"token_definition_list","symbols":[{"rule":"token_definition"}],"postprocess":{"template":"data"}},{"name":"token_definition_list","symbols":[{"rule":"token_definition"},{"rule":"_"},{"rule":"token_definition_list"}],"postprocess":{"template":"[$0].concat($2)"}},{"name":"token_definition","symbols":[{"rule":"K_TAG"},{"rule":"_"},{"rule":"L_COLON"},{"rule":"_"},{"rule":"string_list"}],"postprocess":{"template":"{ tag: $4 }"}},{"name":"token_definition","symbols":[{"rule":"K_WHEN"},{"rule":"_"},{"rule":"L_COLON"},{"rule":"_"},{"rule":"T_STRING"}],"postprocess":{"template":"{ when: $4 }"}},{"name":"token_definition","symbols":[{"rule":"K_WHEN"},{"rule":"_"},{"rule":"L_COLON"},{"rule":"_"},{"rule":"T_REGEX"}],"postprocess":{"template":"{ when: $4 }"}},{"name":"token_definition","symbols":[{"rule":"K_POP"}],"postprocess":{"template":"{ pop: 1 }"}},{"name":"token_definition","symbols":[{"rule":"K_POP"},{"rule":"_"},{"rule":"L_COLON"},{"rule":"_"},{"rule":"T_INTEGER"}],"postprocess":{"template":"{ pop: parseInt($4) }"}},{"name":"token_definition","symbols":[{"rule":"K_POP"},{"rule":"_"},{"rule":"L_COLON"},{"rule":"_"},{"rule":"K_ALL"}],"postprocess":{"template":"{ pop: \"all\" }"}},{"name":"token_definition","symbols":[{"rule":"K_INSET"}],"postprocess":{"template":"{ inset: 1 }"}},{"name":"token_definition","symbols":[{"rule":"K_INSET"},{"rule":"_"},{"rule":"L_COLON"},{"rule":"_"},{"rule":"T_INTEGER"}],"postprocess":{"template":"{ inset: parseInt($4) }"}},{"name":"token_definition","symbols":[{"rule":"K_SET"},{"rule":"_"},{"rule":"L_COLON"},{"rule":"_"},{"rule":"T_WORD"}],"postprocess":{"template":"{ set: $4 }"}},{"name":"token_definition","symbols":[{"rule":"K_GOTO"},{"rule":"_"},{"rule":"L_COLON"},{"rule":"_"},{"rule":"T_WORD"}],"postprocess":{"template":"{ goto: $4 }"}},{"name":"token_definition","symbols":[{"rule":"K_TYPE"},{"rule":"_"},{"rule":"L_COLON"},{"rule":"_"},{"rule":"T_STRING"}],"postprocess":{"template":"{ type: $4 }"}},{"name":"grammar","symbols":[{"rule":"kv_list"},{"rule":"_"},{"rule":"grammar_rule_list"}],"postprocess":{"template":"{ config: Rollup($0), rules: $2 }"}},{"name":"grammar","symbols":[{"rule":"grammar_rule_list"}],"postprocess":{"template":"{ rules: $0 }"}},{"name":"grammar_rule_list","symbols":[{"rule":"grammar_rule"}],"postprocess":{"template":"[$0]"}},{"name":"grammar_rule_list","symbols":[{"rule":"grammar_rule"},{"rule":"_"},{"rule":"grammar_rule_list"}],"postprocess":{"template":"[$0].concat($2)"}},{"name":"grammar_rule","symbols":[{"rule":"T_WORD"},{"rule":"_"},{"rule":"L_ARROW"},{"rule":"_"},{"rule":"expression_list"}],"postprocess":{"template":"{ name: $0, rules: $4 }"}},{"name":"expression_list","symbols":[{"rule":"expression"}]},{"name":"expression_list","symbols":[{"rule":"expression_list"},{"rule":"_"},{"rule":"L_PIPE"},{"rule":"_"},{"rule":"expression"}],"postprocess":{"template":"$0.concat([$4])"}},{"name":"expression","symbols":[{"rule":"expression_symbol_list"}],"postprocess":{"template":"{ symbols: $0 }"}},{"name":"expression","symbols":[{"rule":"expression_symbol_list"},{"rule":"_"},{"rule":"T_JS"}],"postprocess":{"template":"{ symbols: $0, postprocess: $2 }"}},{"name":"expression","symbols":[{"rule":"expression_symbol_list"},{"rule":"_"},{"rule":"T_GRAMMAR_TEMPLATE"}],"postprocess":{"template":"{ symbols: $0, postprocess: { template: $2 } }"}},{"name":"expression_symbol_list","symbols":[{"rule":"expression_symbol"}]},{"name":"expression_symbol_list","symbols":[{"rule":"expression_symbol_list"},{"rule":"T_WS"},{"rule":"expression_symbol"}],"postprocess":{"template":"$0.concat([$2])"}},{"name":"expression_symbol","symbols":[{"rule":"expression_symbol_match"}],"postprocess":{"template":"$0"}},{"name":"expression_symbol","symbols":[{"rule":"expression_symbol_match"},{"rule":"L_COLON"},{"rule":"T_WORD"}],"postprocess":{"template":"{ ...$0,  alias: $2 }"}},{"name":"expression_symbol","symbols":[{"rule":"expression_symbol_match"},{"rule":"expression_repeater"}],"postprocess":{"template":"{ expression: $0, repeat: $1 }"}},{"name":"expression_symbol","symbols":[{"rule":"expression_symbol_match"},{"rule":"expression_repeater"},{"rule":"L_COLON"},{"rule":"T_WORD"}],"postprocess":{"template":"{ expression: $0, repeat: $1, alias: $4 }"}},{"name":"expression_symbol_match","symbols":[{"rule":"T_WORD","alias":"rule"}],"postprocess":{"template":"{ rule: $rule }"}},{"name":"expression_symbol_match$RPT01x1","symbols":[{"literal":"i"}],"postprocess":{"builtin":"first"}},{"name":"expression_symbol_match$RPT01x1","symbols":[],"postprocess":{"builtin":"null"}},{"name":"expression_symbol_match","symbols":[{"rule":"T_STRING"},{"rule":"expression_symbol_match$RPT01x1"}],"postprocess":{"template":"$1 ? Insensitive($0) : { literal: $0 }"}},{"name":"expression_symbol_match","symbols":[{"rule":"L_DSIGN"},{"rule":"T_WORD"}],"postprocess":{"template":"{ token: $1}"}},{"name":"expression_symbol_match","symbols":[{"rule":"L_DSIGN"},{"rule":"T_STRING"}],"postprocess":{"template":"{ token: $1}"}},{"name":"expression_symbol_match","symbols":[{"rule":"T_CHARCLASS"}],"postprocess":{"template":"{ regex: $0 }"}},{"name":"expression_symbol_match","symbols":[{"rule":"L_PARENL"},{"rule":"_"},{"rule":"expression_list"},{"rule":"_"},{"rule":"L_PARENR"}],"postprocess":{"template":"{ subexpression: $2 }"}},{"name":"expression_repeater","symbols":[{"rule":"L_REPEAT_01"}],"postprocess":{"template":"$0[0].value"}},{"name":"expression_repeater","symbols":[{"rule":"L_REPEAT_1N"}],"postprocess":{"template":"$0[0].value"}},{"name":"expression_repeater","symbols":[{"rule":"L_REPEAT_0N"}],"postprocess":{"template":"$0[0].value"}},{"name":"kv_list","symbols":[{"rule":"kv"}],"postprocess":{"template":"data"}},{"name":"kv_list","symbols":[{"rule":"kv"},{"rule":"_"},{"rule":"kv_list"}],"postprocess":{"template":"[$0].concat($2)"}},{"name":"kv$SUBx1","symbols":[{"rule":"T_WORD"}]},{"name":"kv$SUBx1","symbols":[{"rule":"T_STRING"}]},{"name":"kv$SUBx1","symbols":[{"rule":"T_INTEGER"}]},{"name":"kv","symbols":[{"rule":"T_WORD"},{"rule":"_"},{"rule":"L_COLON"},{"rule":"_"},{"rule":"kv$SUBx1"}],"postprocess":{"template":"{ [$0]: $4[0] }"}},{"name":"string_list","symbols":[{"rule":"T_STRING"}],"postprocess":{"template":"[$0]"}},{"name":"string_list","symbols":[{"rule":"T_STRING"},{"rule":"_"},{"rule":"L_COMMA"},{"rule":"_"},{"rule":"string_list"}],"postprocess":{"template":"[$0].concat($4)"}},{"name":"word_list","symbols":[{"rule":"T_WORD"}],"postprocess":{"template":"[$0]"}},{"name":"word_list","symbols":[{"rule":"T_WORD"},{"rule":"_"},{"rule":"L_COMMA"},{"rule":"_"},{"rule":"word_list"}],"postprocess":{"template":"[$0].concat($4)"}},{"name":"_$RPT01x1","symbols":[{"rule":"T_WS"}],"postprocess":{"builtin":"first"}},{"name":"_$RPT01x1","symbols":[],"postprocess":{"builtin":"null"}},{"name":"_","symbols":[{"rule":"_$RPT01x1"}],"postprocess":{"template":"null"}},{"name":"L_COLON","symbols":[{"token":"L_COLON"}]},{"name":"L_REPEAT_01","symbols":[{"token":"L_REPEAT_01"}]},{"name":"L_REPEAT_1N","symbols":[{"token":"L_REPEAT_1N"}]},{"name":"L_REPEAT_0N","symbols":[{"token":"L_REPEAT_0N"}]},{"name":"L_COMMA","symbols":[{"token":"L_COMMA"}]},{"name":"L_PIPE","symbols":[{"token":"L_PIPE"}]},{"name":"L_PARENL","symbols":[{"token":"L_PARENL"}]},{"name":"L_PARENR","symbols":[{"token":"L_PARENR"}]},{"name":"L_TEMPLATEL","symbols":[{"token":"L_TEMPLATEL"}]},{"name":"L_TEMPLATER","symbols":[{"token":"L_TEMPLATER"}]},{"name":"L_ARROW","symbols":[{"token":"L_ARROW"}]},{"name":"L_DSIGN","symbols":[{"token":"L_DSIGN"}]},{"name":"L_DASH","symbols":[{"token":"L_DASH"}]},{"name":"K_ALL","symbols":[{"literal":"all"}]},{"name":"K_TAG","symbols":[{"literal":"tag"}]},{"name":"K_TYPE","symbols":[{"literal":"type"}]},{"name":"K_WHEN","symbols":[{"literal":"when"}]},{"name":"K_POP","symbols":[{"literal":"pop"}]},{"name":"K_INSET","symbols":[{"literal":"inset"}]},{"name":"K_SET","symbols":[{"literal":"set"}]},{"name":"K_GOTO","symbols":[{"literal":"goto"}]},{"name":"K_CONFIG","symbols":[{"literal":"config"}]},{"name":"K_LEXER","symbols":[{"literal":"lexer"}]},{"name":"K_GRAMMAR","symbols":[{"literal":"grammar"}]},{"name":"K_IMPORT","symbols":[{"literal":"import"}]},{"name":"K_BODY","symbols":[{"literal":"body"}]},{"name":"K_HEAD","symbols":[{"literal":"head"}]},{"name":"T_JS$RPT0Nx1","symbols":[]},{"name":"T_JS$RPT0Nx1","symbols":[{"rule":"T_JS$RPT0Nx1"},{"token":"T_JSBODY"}],"postprocess":{"builtin":"concat"}},{"name":"T_JS","symbols":[{"token":"L_JSL"},{"rule":"T_JS$RPT0Nx1"},{"token":"L_JSR"}],"postprocess":{"template":"$1.map(v=>v.value).join('')"}},{"name":"T_GRAMMAR_TEMPLATE$RPT0Nx1","symbols":[]},{"name":"T_GRAMMAR_TEMPLATE$RPT0Nx1","symbols":[{"rule":"T_GRAMMAR_TEMPLATE$RPT0Nx1"},{"token":"T_JSBODY"}],"postprocess":{"builtin":"concat"}},{"name":"T_GRAMMAR_TEMPLATE","symbols":[{"token":"L_TEMPLATEL"},{"rule":"_"},{"rule":"T_GRAMMAR_TEMPLATE$RPT0Nx1"},{"rule":"_"},{"token":"L_TEMPLATER"}],"postprocess":{"template":"$2.map(v=>v.value).join('').trim()"}},{"name":"T_STRING","symbols":[{"token":"T_STRING"}],"postprocess":{"template":"JSON.parse($0.value)"}},{"name":"T_WORD","symbols":[{"token":"T_WORD"}],"postprocess":{"template":"$0.value"}},{"name":"T_REGEX$RPT0Nx1","symbols":[]},{"name":"T_REGEX$RPT0Nx1","symbols":[{"rule":"T_REGEX$RPT0Nx1"},{"regex":"[gmiuy]"}],"postprocess":{"builtin":"concat"}},{"name":"T_REGEX","symbols":[{"token":"T_REGEX"},{"rule":"T_REGEX$RPT0Nx1"}],"postprocess":{"template":"{ regex: $0.value.slice(1,-1), flags: $1.join('') }"}},{"name":"T_COMMENT","symbols":[{"token":"T_COMMENT"}]},{"name":"T_CHARCLASS","symbols":[{"token":"T_CHARCLASS"}],"postprocess":{"template":"$0.value"}},{"name":"T_INTEGER","symbols":[{"token":"T_INTEGER"}],"postprocess":{"template":"$0.value"}},{"name":"T_WS","symbols":[{"token":"T_WS"}],"postprocess":{"template":"null"}}],"names":{}},"lexer":{"start":"start","states":[{"name":"start","rules":[{"import":["string","js","ws","comment"]},{"when":{"regex":"lexer(?![a-zA-Z\\d_])","flags":""},"type":"T_WORD","goto":"lexer"},{"when":{"regex":"grammar(?![a-zA-Z\\d_])","flags":""},"type":"T_WORD","goto":"grammar"},{"when":{"regex":"config(?![a-zA-Z\\d_])","flags":""},"type":"T_WORD","goto":"config"},{"import":["kv"]}]},{"name":"config","rules":[{"import":["ws"]},{"when":"{{","type":"L_TEMPLATEL","set":"config_inner"}]},{"name":"config_inner","rules":[{"import":["comment","kv"]},{"when":"}}","type":"L_TEMPLATER","pop":1}]},{"name":"grammar","rules":[{"import":["ws"]},{"when":"{{","type":"L_TEMPLATEL","set":"grammar_inner"}]},{"name":"grammar_inner","rules":[{"import":["comment","js","js_template","ws","regex","charclass","l_repeat_01","l_repeat_1n","l_repeat_0n","kv","l_colon","l_comma","l_pipe","l_parenl","l_parenr","l_arrow","l_dsign","l_dash"]},{"when":"}}","type":"L_TEMPLATER","pop":1}]},{"name":"lexer","rules":[{"import":["ws"]},{"when":"{{","type":"L_TEMPLATEL","set":"lexer_inner"}]},{"name":"lexer_inner","rules":[{"import":["ws","comment","regex","l_comma","l_arrow","l_dash","kv","js"]},{"when":"}}","type":"L_TEMPLATER","pop":1}]},{"name":"js","rules":[{"when":"${","type":"L_JSL","goto":"js_wrap"}]},{"name":"js_wrap","default":"T_JSBODY","unmatched":"T_JSBODY","rules":[{"import":["jsignore"]},{"when":"{","type":"T_JSBODY","goto":"js_literal"},{"when":"}","type":"L_JSR","pop":1}]},{"name":"js_literal","default":"T_JSBODY","unmatched":"T_JSBODY","rules":[{"import":["jsignore"]},{"when":"{","type":"T_JSBODY","goto":"js_literal"},{"when":"}","type":"T_JSBODY","pop":1}]},{"name":"js_template","rules":[{"when":"{{","type":"L_TEMPLATEL","goto":"js_template_inner"}]},{"name":"js_template_inner","default":"T_JSBODY","unmatched":"T_JSBODY","rules":[{"import":["jsignore"]},{"when":"{","type":"T_JSBODY","goto":"js_literal"},{"when":"}}","type":"L_TEMPLATER","pop":1}]},{"name":"kv","rules":[{"import":["string","ws","word","l_colon","integer"]}]},{"name":"jsignore","rules":[{"when":{"regex":"\"(?:[^\"\\\\]|\\\\.)*\"","flags":""},"type":"T_JSBODY"},{"when":{"regex":"'(?:[^'\\\\]|\\\\.)*'","flags":""},"type":"T_JSBODY"},{"when":{"regex":"`(?:[^`\\\\]|\\\\.)*`","flags":""},"type":"T_JSBODY"},{"when":{"regex":"\\/(?:[^\\/\\\\]|\\\\.)+\\/[gmiyu]*","flags":""},"type":"T_JSBODY"},{"when":{"regex":"\\/\\/[\\n]*","flags":""},"type":"T_JSBODY"},{"when":{"regex":"\\/\\*.*\\*\\/","flags":""},"type":"T_JSBODY"}]},{"name":"string","rules":[{"when":{"regex":"\"(?:[^\"\\\\\\r\\n]|\\\\.)*\"","flags":""},"type":"T_STRING"}]},{"name":"string2","rules":[{"when":{"regex":"'(?:[^'\\\\\\r\\n]|\\\\.)*'","flags":""},"type":"T_STRING"}]},{"name":"string3","rules":[{"when":{"regex":"`(?:[^`\\\\]|\\\\.)*`","flags":""},"type":"T_STRING"}]},{"name":"charclass","rules":[{"when":{"regex":"\\[(?:[^\\]\\\\]|\\\\.)+\\]","flags":""},"type":"T_CHARCLASS"}]},{"name":"regex","rules":[{"when":{"regex":"\\/(?:[^\\/\\\\\\r\\n]|\\\\.)+\\/","flags":""},"type":"T_REGEX"}]},{"name":"integer","rules":[{"when":{"regex":"\\d+","flags":""},"type":"T_INTEGER"}]},{"name":"word","rules":[{"when":{"regex":"[a-zA-Z_][a-zA-Z_\\d]*","flags":""},"type":"T_WORD"}]},{"name":"ws","rules":[{"when":{"regex":"\\s+","flags":""},"type":"T_WS"}]},{"name":"l_colon","rules":[{"when":":","type":"L_COLON"}]},{"name":"l_repeat_01","rules":[{"when":"?","type":"L_REPEAT_01"}]},{"name":"l_repeat_1n","rules":[{"when":"+","type":"L_REPEAT_1N"}]},{"name":"l_repeat_0n","rules":[{"when":"*","type":"L_REPEAT_0N"}]},{"name":"l_comma","rules":[{"when":",","type":"L_COMMA"}]},{"name":"l_pipe","rules":[{"when":"|","type":"L_PIPE"}]},{"name":"l_parenl","rules":[{"when":"(","type":"L_PARENL"}]},{"name":"l_parenr","rules":[{"when":")","type":"L_PARENR"}]},{"name":"l_templatel","rules":[{"when":"{{","type":"L_TEMPLATEL"}]},{"name":"l_templater","rules":[{"when":"}}","type":"L_TEMPLATER"}]},{"name":"l_arrow","rules":[{"when":"->","type":"L_ARROW"}]},{"name":"l_dsign","rules":[{"when":"$","type":"L_DSIGN"}]},{"name":"l_dash","rules":[{"when":"-","type":"L_DASH"}]},{"name":"comment","rules":[{"when":{"regex":"\\/\\/[\\n]*","flags":""},"type":"T_COMMENT"}]},{"name":"commentmulti","rules":[{"when":{"regex":"\\/\\*.*\\*\\/","flags":""},"type":"T_COMMENT"}]}]},"head":["\n    function Insensitive({ literal }) {\n        const symbols = [];\n        for (let i = 0; i < literal.length; i++) {\n            const c = literal.charAt(i);\n            if (c.toUpperCase() !== c || c.toLowerCase() !== c) {\n                symbols.push(new RegExp(\"[\" + c.toLowerCase() + c.toUpperCase() + \"]\"));\n            } else {\n                symbols.push({ literal: c });\n            }\n        }\n        return { subexpression: [{ symbols, postprocess: ({data}) => data.join('') }] };\n    }\n\n    function Rollup(ary){\n        const r = {};\n        for(const i of ary){\n            for(const k in i){\n                r[k] = i[k];\n            }\n        }\n        return r;\n    };\n"],"body":[],"config":{},"version":"unknown"},"exportName":"GWLanguage"}